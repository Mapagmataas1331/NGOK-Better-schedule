import{p as D,t as f,i as M,c as i,a as t,s as zt,b as Ke,d as L,e as F,f as $,g as Et}from"../chunks/DXY0rfsH.js";import{p as Ut,s as ee,t as x,a as qt,b as c,c as Q,g as e,d as l,u as At,f as d,e as te,n as z,r as H,h as Xe}from"../chunks/B2PMlZio.js";import{t as Ie,C as Bt,k as Wt}from"../chunks/DhA_3YI6.js";import{B as Ae,l as Ft,e as Je,i as Ze,c as Ht,s as Nt}from"../chunks/DC8nUZzH.js";import{s as nt,p as Vt}from"../chunks/DWwFZPDY.js";import{o as Yt,a as Gt}from"../chunks/GrwCXr2j.js";import{$ as Me,a as Le,S as Qt,T as Kt,P as Xt,C as Jt,b as Zt,c as et,d as er,e as tr,f as rr,g as ar,R as sr,h as dt,v as or,i as lr,j as nr,k as dr,l as tt,B as ir,A as it,m as ct,n as ut,H as cr,o as vt,p as ur,M as vr,q as fr,r as Be,s as ft,t as pr,u as Se,w as _r}from"../chunks/B6H9WgdX.js";import{S as hr}from"../chunks/WAdjd4xe.js";import{X as mr}from"../chunks/_fsvTDOQ.js";var gr=f('<div class="absolute top-[20dvh]"><h1 class="mb-4 text-center text-3xl font-bold md:text-4xl"> </h1> <p class=" text-center"> </p></div>'),$r=f(" <!>",1),xr=f("<!> ",1),br=f("<!> <!>",1),yr=f("<!> <!>",1),wr=f("<!> <!>",1),kr=f('<div class="group flex min-h-9 w-full flex-col items-center justify-center rounded-md border-input bg-background px-3 py-2 font-medium shadow-md"><div class="flex w-full items-center justify-between text-sm"><!> <!></div> <!> <!></div>'),Sr=f("<!> <!> <!>",1),Pr=f("<!> <!>",1),Tr=f(" <!>",1),Dr=f("<!> <!>",1),Or=f('<a target="_blank" class="underline"> </a>'),Cr=f("<!> <!>",1),Rr=f("<!> <!>",1),jr=f("<!> <!>",1),Ir=f("<!> <!>",1),Mr=f('<div class="w-full min-w-[320px] max-w-[512px] rounded-md border bg-background p-1 shadow-md"><!></div>'),Lr=f("<div></div>"),zr=f('<!> <p> </p> <p class="font-semibold !text-cyan-700 dark:!text-cyan-400"> </p>',1),Er=f('Лучшая <span class="!text-green-700 dark:!text-green-400">благодарность</span> <a class="font-semibold hover:underline" href="https://ma.cyou/">Автору</a>',1),Ur=f('Best Thanks to the <a class="font-semibold hover:underline" href="https://ma.cyou/">Author</a>',1),qr=f('это подписка на <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331">GitHub</a> и звездочка на <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331/ma">Репозиторий</a>',1),Ar=f('is a subscription on <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331">GitHub</a> and a star on <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331/ma">Repository</a>',1),Br=f("<!> <!> <!>",1),Wr=f("<!> <!>",1),Fr=f('<div><!> <!> <div class="md:1/2 m-1 mt-3 flex w-full flex-col gap-y-2 md:w-[512px]"><div class="flex flex-row gap-0"><!> <!></div> <!></div> <!> <!></div>');function Zr(pt,_t){Ut(_t,!0);const[We,ht]=zt(),b=()=>Ke(Ft,"$language",We),mt=()=>Ke(Vt,"$page",We),Fe=()=>Ke(or,"$viewport",We);let p=ee(""),Pe=ee(!1),ze=ee(null);function gt(){l(Pe,!1),Xe().then(()=>{e(ze).focus()})}let U=ee(D({start:Me(Le()),end:Me(Le()).add({days:6})})),ge=ee(""),I=null,Te={},$e=ee(D({})),ve=ee(D({})),He=ee(!1),O=ee(""),re=ee(null),q=null;const $t=async()=>{l(O,"loading");const r=await dt("teacher");if((r.scheduleError||!r.schedule)&&(e(re)||!I)){l(O,"error"),l(re,D(r.scheduleError)),q&&clearInterval(q);return}I=r.schedule,l(re,D(r.scheduleError)),await Xe(),l(O,"hidden"),l($e,D(yt())),Te=St()},Ee=async(r=!0)=>{bt(),e(p)&&(l(He,!0),e(p)&&e(U)&&(Ne(),r&&l(ge,D(e(p)))),q&&clearInterval(q),await Xe(),q=setInterval(async()=>{if(!e(p)){q&&clearInterval(q);return}const a=await dt("student");if((a.scheduleError||!a.schedule)&&(e(re)||!I)){l(O,"error"),l(re,D(a.scheduleError)),q&&clearInterval(q);return}if(I=a.schedule,Ie.success(b()==="ru"?"Расписание обновлено в "+new Date().toLocaleString("ru-RU",{hour12:!1}):"Schedule updated at "+new Date().toLocaleString("en-US",{hour12:!1})),!e(p)){q&&clearInterval(q);return}Ne()},3e5))},xt=()=>{e(p)&&e(U)&&Ne()},Ne=()=>{if(!e(U).start||!e(U).end){l(O,"hidden");return}l(O,"loading");const r=vt(e(U).start),a=vt(e(U).end);let o=[],s=r;for(;s<=a;){const v=String(s.getDate()).padStart(2,"0"),n=String(s.getMonth()+1).padStart(2,"0"),h=s.getFullYear().toString().slice(-2),u=`${v}.${n}.${h}`;o.push(u),s.setDate(s.getDate()+1)}l(ve,D(o.reduce((v,n)=>{if(!I)return l(re,"Error: Schedule is null"),l(O,"error"),{};let h=[];if(Te[n])for(let u=Te[n];u<Te[wt(n)]||u<Te[n]+6*2;u+=2){const C=I[2][u],y=I[e($e)[e(p)]][u],m=I[e($e)[e(p)]+1][u],_=I[e($e)[e(p)]][u+1];y&&h.push({time:C||"",group:y||"",type:m||"",auditorium:_||""})}return v[n]=h,v},{}))),l(O,"visible")},bt=()=>{l(O,"hidden"),l(ve,D({})),l(He,!1),l(U,D({start:Me(Le()),end:Me(Le()).add({days:6})}))},yt=()=>I?I.reduce((r,a,o)=>{const s=a[1];return o>2&&s&&!r[s]&&(r[s]=o),r},{}):(l(re,"Error: Schedule is null"),l(O,"error"),{}),wt=r=>{const[a,o,s]=r.split("."),v=new Date(`20${s}-${o}-${a}`);v.setDate(v.getDate()+1);const n=String(v.getDate()).padStart(2,"0"),h=String(v.getMonth()+1).padStart(2,"0"),u=v.getFullYear().toString().slice(-2);return`${n}.${h}.${u}`},kt=(r,a="ru")=>{let o=[];a==="ru"?o=["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"]:o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];const[s,v,n]=r.split("."),h=new Date(`20${n}-${v}-${s}`);return o[h.getDay()]||"Неизвестный день!"},St=()=>I?I[0].reduce((r,a,o)=>{const s=a.split(" ")[1];return o>1&&s&&s!=="undefined"&&/\b(\d{2}\.\d{2}\.\d{4})\b/.test(s)&&(r[`${s.slice(0,-4)}${s.split(".")[2].slice(-2)}`]=o),r},{}):(l(re,"Error: Schedule is null"),l(O,"error"),{});Yt(async()=>{$t(),l(ge,D(localStorage.getItem("tlq")||"")),At((a=e(ge))=>{localStorage.setItem("tlq",a)});const r=mt().url.searchParams.get("q")||"";if(r){const a=decodeURI(r),o=()=>{if(!e($e)[a]){Ie.error(b()==="ru"?`Некорректный преподаватель передан в URL: "${a}"`:`Incorrect teacher passed in URL: "${a}"`);return}l(p,D(a)),Ee(),Ie.success(b()==="ru"?`Преподаватель "${a}" успешно загружен из URL`:`"${a}" teacher are successfully loaded from URL`);const s=new URL(window.location.href);s.searchParams.delete("q"),history.replaceState({},"",s.toString())};if(I)o();else{const s=setInterval(()=>{I&&(clearInterval(s),o())},500)}}}),Gt(()=>{q&&clearInterval(q)});var Ue=Fr(),rt=Q(Ue);{var Pt=r=>{var a=gr(),o=Q(a),s=Q(o,!0);H(o);var v=c(o,2),n=Q(v,!0);H(v),H(a),x(()=>{$(s,b()==="ru"?"Расписание НГОК Преподавателям":"NGOK Schedule for Teachers"),$(n,b()==="ru"?"Выберите преподавателя, чтобы увидеть расписание":"Select a teacher to see the schedule")}),t(r,a)};M(rt,r=>{e(O)!=="visible"&&r(Pt)})}var at=c(rt,2);Ae(at,{variant:"outline",size:"icon",class:"fixed right-14 top-2.5 z-40 md:right-16 md:top-3.5",onclick:()=>{e(p)?(navigator.clipboard.writeText(`${window.location.origin}/teacher?q=${encodeURI(e(p))}`),Ie.success(b()==="ru"?`Ссылка для преподователя "${e(p)}" скопирована в буфер обмена!`:`Link for "${e(p)}" teacher copied to clipboard!`)):Ie.error(b()==="ru"?"Сначала выберите преподавателя":"Select a teacher first")},children:(r,a)=>{Qt(r,{class:"!size-5"})},$$slots:{default:!0}});var Ve=c(at,2),Ye=Q(Ve),st=Q(Ye);i(st,()=>sr,(r,a)=>{a(r,{get open(){return e(Pe)},set open(o){l(Pe,D(o))},children:(o,s)=>{var v=wr(),n=d(v);i(n,()=>Kt,(u,C)=>{C(u,{get ref(){return e(ze)},set ref(m){l(ze,D(m))},child:(m,_)=>{let w=()=>_==null?void 0:_().props;const g=te(()=>`w-full justify-between px-3 py-2${e(p)?" rounded-r-none":""}`);Ae(m,Et({variant:"outline",get class(){return e(g)}},w,{role:"combobox",get"aria-expanded"(){return e(Pe)},children:(R,P)=>{z();var j=$r(),S=d(j),N=c(S);ar(N,{class:"opacity-50"}),x(()=>$(S,`${(e(p)?e(p):b()==="ru"?"Выберите преподавателя":"Select a teacher")??""} `)),t(R,j)},$$slots:{default:!0}}))},$$slots:{child:!0}})});var h=c(n,2);i(h,()=>Xt,(u,C)=>{C(u,{class:"z-10 mt-[3px] w-[calc(100dvw-8px)] p-0 md:w-[320px]",children:(y,m)=>{var _=L(),w=d(_);i(w,()=>Jt,(g,R)=>{R(g,{children:(P,j)=>{var S=yr(),N=d(S);const ae=te(()=>b()==="ru"?"Искать преподавателя":"Search for a teacher");i(N,()=>Zt,(k,E)=>{E(k,{get placeholder(){return e(ae)},class:"h-9",onfocusin:()=>{Fe().vw<et.md&&window.scrollTo({top:window.scrollY+e(ze).getBoundingClientRect().top-8,behavior:"smooth"})},onfocusout:()=>{Fe().vw<et.md&&(l(Pe,!1),window.scrollTo({top:0,behavior:"smooth"}))}})});var xe=c(N,2);i(xe,()=>er,(k,E)=>{E(k,{children:(Ge,lt)=>{var be=br(),ye=d(be);i(ye,()=>tr,(Oe,se)=>{se(Oe,{children:(fe,Ce)=>{z();var oe=F();x(()=>$(oe,b()==="ru"?"Нет результатов":"No results")),t(fe,oe)},$$slots:{default:!0}})});var De=c(ye,2);i(De,()=>rr,(Oe,se)=>{se(Oe,{class:"max-h-[256px] overflow-y-auto",children:(fe,Ce)=>{var oe=L(),K=d(oe);Je(K,17,()=>Object.keys(e($e)),Ze,(de,V)=>{var le=L(),pe=d(le);i(pe,()=>lr,(A,T)=>{T(A,{get value(){return e(V)},onSelect:()=>{l(p,D(e(V))),Ee(),gt()},children:(B,_e)=>{var Y=xr(),X=d(Y);const we=te(()=>Ht(e(p)!==e(V)&&"text-transparent"));Bt(X,{get class(){return e(we)}});var ie=c(X);x(()=>$(ie,` ${e(V)??""}`)),t(B,Y)},$$slots:{default:!0}})}),t(de,le)}),t(fe,oe)},$$slots:{default:!0}})}),t(Ge,be)},$$slots:{default:!0}})}),t(P,S)},$$slots:{default:!0}})}),t(y,_)},$$slots:{default:!0}})}),t(o,v)},$$slots:{default:!0}})});var Tt=c(st,2);{var Dt=r=>{Ae(r,{variant:"outline",size:"icon",class:"shrink-0 rounded-l-none border-l-0",onclick:()=>{l(p,""),Ee()},children:(a,o)=>{mr(a,{class:"opacity-50"})},$$slots:{default:!0}})};M(Tt,r=>{e(p)&&r(Dt)})}H(Ye);var Ot=c(Ye,2);{var Ct=r=>{var a=L();const o=te(()=>Fe().vw>=et.md?2:1),s=te(()=>b()==="ru"?"ru":"en");var v=d(a);Wt(v,()=>[e(o),e(s)],n=>{var h=kr(),u=Q(h),C=Q(u);{var y=j=>{var S=F();x((N,ae)=>$(S,`${N??""} - ${ae??""}`),[()=>tt(e(U).start),()=>tt(e(U).end)]),t(j,S)},m=j=>{var S=F();x(()=>$(S,b()==="ru"?"Выберите период":"Select a range")),t(j,S)};M(C,j=>{e(U).start&&e(U).end?j(y):j(m,!1)})}var _=c(C,2);nr(_,{class:"size-4 opacity-50"}),H(u);var w=c(u,2);hr(w,{class:"mt-2 hidden group-hover:block"});var g=c(w,2);const R=te(()=>e(s)==="ru"?0:1),P=te(()=>e(s)==="ru"?"ru":"en");dr(g,{get weekStartsOn(){return e(R)},get numberOfMonths(){return e(o)},class:"hidden capitalize group-hover:block",onValueChange:xt,get locale(){return e(P)},get value(){return e(U)},set value(j){l(U,D(j))}}),H(h),t(n,h)}),t(r,a)};M(Ot,r=>{e(He)&&r(Ct)})}H(Ve);var ot=c(Ve,2);{var Rt=r=>{var a=L(),o=d(a);i(o,()=>ut,(s,v)=>{v(s,{class:"md:1/2 my-1 w-full md:w-[512px]",children:(n,h)=>{var u=Sr(),C=d(u);ir(C,{class:"size-8"});var y=c(C,2);i(y,()=>it,(_,w)=>{w(_,{class:"!pl-12",children:(g,R)=>{z();var P=F();x(()=>$(P,b()==="ru"?"Возникла проблема":"Error Occurred")),t(g,P)},$$slots:{default:!0}})});var m=c(y,2);i(m,()=>ct,(_,w)=>{w(_,{class:"!pl-12",children:(g,R)=>{z();var P=F();x(()=>$(P,e(re))),t(g,P)},$$slots:{default:!0}})}),t(n,u)},$$slots:{default:!0}})}),t(r,a)},jt=r=>{var a=L(),o=d(a);{var s=n=>{ur(n,{class:"md:1/2 my-1 h-8 w-full md:w-[512px]"})},v=n=>{var h=L(),u=d(h);{var C=y=>{var m=Lr();Je(m,21,()=>Object.entries(e(ve)),Ze,(_,w)=>{let g=()=>e(w)[0],R=()=>e(w)[1];var P=Mr(),j=Q(P);i(j,()=>_r,(S,N)=>{N(S,{children:(ae,xe)=>{var k=Ir(),E=d(k);const Ge=te(()=>g()===tt(Me(Le()))?"bg-green-100 dark:bg-green-800/50":R().length>0?"bg-blue-100 dark:bg-blue-800/50":"mt-4 bg-red-100 p-4 dark:bg-red-800/50");i(E,()=>fr,(be,ye)=>{ye(be,{get class(){return`text-base ${e(Ge)??""}`},children:(De,Oe)=>{var se=L(),fe=d(se);i(fe,()=>Be,(Ce,oe)=>{oe(Ce,{children:(K,de)=>{var V=Pr(),le=d(V);i(le,()=>ft,(A,T)=>{T(A,{class:"w-1/3 text-right font-semibold text-foreground",children:(B,_e)=>{z();var Y=F();x(()=>$(Y,g())),t(B,Y)},$$slots:{default:!0}})});var pe=c(le,2);i(pe,()=>ft,(A,T)=>{T(A,{class:"w-2/3 text-left font-semibold text-foreground",children:(B,_e)=>{z();var Y=F();x(X=>$(Y,X),[()=>kt(g(),b())]),t(B,Y)},$$slots:{default:!0}})}),t(K,V)},$$slots:{default:!0}})}),t(De,se)},$$slots:{default:!0}})});var lt=c(E,2);i(lt,()=>pr,(be,ye)=>{ye(be,{class:"bg-background",children:(De,Oe)=>{var se=L(),fe=d(se);{var Ce=K=>{var de=jr(),V=d(de);{var le=A=>{var T=L(),B=d(T);i(B,()=>Be,(_e,Y)=>{Y(_e,{children:(X,we)=>{var ie=L(),Qe=d(ie);i(Qe,()=>Se,(he,me)=>{me(he,{class:"text-center font-semibold italic",colspan:2,children:(Re,ce)=>{z();var J=Tr();const G=te(()=>{var ue;return(ue=R()[0])==null?void 0:ue.time});var ke=d(J),W=c(ke);{var je=ue=>{var qe=F();const Z=te(()=>e(G).includes("-")?e(G).split("-")[0]:e(G));x(ne=>$(qe,ne),[()=>e(Z).includes(".")?e(Z).replace(/\./g,":"):e(Z)]),t(ue,qe)};M(W,ue=>{e(G)&&ue(je)})}x(()=>$(ke,`${(b()==="ru"?"Пары начинаются с":"Lessons start at")??""} `)),t(Re,J)},$$slots:{default:!0}})}),t(X,ie)},$$slots:{default:!0}})}),t(A,T)};M(V,A=>{R()[0].time.startsWith("09:00")||A(le)})}var pe=c(V,2);Je(pe,17,R,Ze,(A,T)=>{var B=Rr(),_e=d(B);i(_e,()=>Be,(X,we)=>{we(X,{children:(ie,Qe)=>{var he=Dr(),me=d(he);i(me,()=>Se,(ce,J)=>{J(ce,{class:"text-right",children:(G,ke)=>{z();var W=F();x(je=>$(W,je),[()=>e(T).time.includes(".")?e(T).time.replace(/\./g,":"):e(T).time]),t(G,W)},$$slots:{default:!0}})});var Re=c(me,2);i(Re,()=>Se,(ce,J)=>{J(ce,{class:"text-left",children:(G,ke)=>{z();var W=F();x(()=>$(W,e(T).group)),t(G,W)},$$slots:{default:!0}})}),t(ie,he)},$$slots:{default:!0}})});var Y=c(_e,2);i(Y,()=>Be,(X,we)=>{we(X,{children:(ie,Qe)=>{var he=Cr(),me=d(he);i(me,()=>Se,(ce,J)=>{J(ce,{class:"text-right",children:(G,ke)=>{var W=L(),je=d(W);{var ue=Z=>{var ne=Or(),Lt=Q(ne,!0);H(ne),x(()=>{Nt(ne,"href",e(T).auditorium),$(Lt,b()==="ru"?"Онлайн":"Online")}),t(Z,ne)},qe=Z=>{var ne=F();x(()=>$(ne,e(T).auditorium)),t(Z,ne)};M(je,Z=>{e(T).auditorium.startsWith("http")?Z(ue):Z(qe,!1)})}t(G,W)},$$slots:{default:!0}})});var Re=c(me,2);i(Re,()=>Se,(ce,J)=>{J(ce,{class:"text-left",children:(G,ke)=>{z();var W=F();x(()=>$(W,e(T).type)),t(G,W)},$$slots:{default:!0}})}),t(ie,he)},$$slots:{default:!0}})}),t(A,B)}),t(K,de)},oe=K=>{var de=L(),V=d(de);i(V,()=>Se,(le,pe)=>{pe(le,{class:"text-center font-semibold italic",colspan:2,children:(A,T)=>{z();var B=F();x(()=>$(B,b()==="ru"?"Нет пар":"No lessons")),t(A,B)},$$slots:{default:!0}})}),t(K,de)};M(fe,K=>{R().length>0?K(Ce):K(oe,!1)})}t(De,se)},$$slots:{default:!0}})}),t(ae,k)},$$slots:{default:!0}})}),H(P),t(_,P)}),H(m),x((_,w,g)=>nt(m,`mx-auto my-1.5 grid grid-cols-1 justify-items-center gap-x-2 gap-y-3 md:p-2${_??""}${w??""}${g??""}`),[()=>Object.keys(e(ve)).length>1?" lg:grid-cols-2 ":"",()=>Object.keys(e(ve)).length>2?" 2xl:grid-cols-3 ":"",()=>Object.keys(e(ve)).length>3?" min-[1792px]:grid-cols-4":""]),t(y,m)};M(u,y=>{e(O)==="visible"&&e(ve)&&y(C)},!0)}t(n,h)};M(o,n=>{e(O)==="loading"?n(s):n(v,!1)},!0)}t(r,a)};M(ot,r=>{e(O)==="error"?r(Rt):r(jt,!1)})}var It=c(ot,2);{var Mt=r=>{var a=Wr(),o=d(a);{var s=n=>{Ae(n,{variant:"outline",class:"md:1/2 my-1 w-full !justify-start py-5 md:w-[512px]",onclick:async()=>{l(p,D(e(ge))),Ee()},children:(h,u)=>{var C=zr(),y=d(C);vr(y,{class:"ml-1 mr-2.5 !size-6 !text-cyan-700 dark:!text-cyan-400"});var m=c(y,2),_=Q(m,!0);H(m);var w=c(m,2),g=Q(w,!0);H(w),x(()=>{$(_,b()==="ru"?"Последний запрос: ":"Last query:"),$(g,e(ge))}),t(h,C)},$$slots:{default:!0}})};M(o,n=>{e(ge)&&e(O)!=="loading"&&n(s)})}var v=c(o,2);i(v,()=>ut,(n,h)=>{h(n,{class:"md:1/2 my-1 w-full md:w-[512px]",children:(u,C)=>{var y=Br(),m=d(y);cr(m,{class:"size-8 !text-green-700 dark:!text-green-400"});var _=c(m,2);i(_,()=>it,(g,R)=>{R(g,{class:"!pl-12",children:(P,j)=>{var S=L(),N=d(S);{var ae=k=>{var E=Er();z(3),t(k,E)},xe=k=>{var E=Ur();z(),t(k,E)};M(N,k=>{b()==="ru"?k(ae):k(xe,!1)})}t(P,S)},$$slots:{default:!0}})});var w=c(_,2);i(w,()=>ct,(g,R)=>{R(g,{class:"!pl-12",children:(P,j)=>{var S=L(),N=d(S);{var ae=k=>{var E=qr();z(3),t(k,E)},xe=k=>{var E=Ar();z(3),t(k,E)};M(N,k=>{b()==="ru"?k(ae):k(xe,!1)})}t(P,S)},$$slots:{default:!0}})}),t(u,y)},$$slots:{default:!0}})}),t(r,a)};M(It,r=>{e(O)!=="visible"&&r(Mt)})}H(Ue),x(()=>nt(Ue,`${(e(p)?"justify-start":"justify-center")??""} mx-auto flex min-h-[calc(100dvh_-_3.5rem)] w-full flex-col items-center bg-gradient-to-br from-white to-sky-200 px-1 dark:from-sky-800 dark:to-black md:min-h-[calc(100dvh_-_4rem)]`)),t(pt,Ue),qt(),ht()}export{Zr as component};
