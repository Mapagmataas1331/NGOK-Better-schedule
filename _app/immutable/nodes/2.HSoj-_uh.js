import{p as O,t as f,i as M,a as t,s as zt,b as Qe,c as I,d as F,e as x,f as Et}from"../chunks/CHDbkL9n.js";import{p as Ut,s as ee,t as b,a as qt,b as i,c as Q,g as e,d as o,u as Gt,f as n,e as te,n as L,r as H,h as Ke}from"../chunks/BW5O_Kuy.js";import{t as Ce,C as At,k as Bt}from"../chunks/XQtzLBlb.js";import{l as Ft,e as Xe,i as Je,c as Ht,s as Nt}from"../chunks/4LsEG6DZ.js";import{c as d}from"../chunks/TqRWhDz0.js";import{s as nt,p as Vt}from"../chunks/DLlEpYLa.js";import{o as Wt,a as Yt}from"../chunks/BaNWsKEw.js";import{$ as Re,a as Me,S as Qt,T as Kt,P as Xt,C as Jt,b as Zt,c as er,d as tr,e as rr,f as ar,R as sr,g as dt,h as it,i as or,j as lr,k as nr,l as Ze,B as dr,m as ir,v as cr,n as ur,M as vr,o as fr,p as qe,q as ct,r as pr,s as Se,t as mr}from"../chunks/DeZSa2zD.js";import{B as Ge}from"../chunks/BEwGYs8X.js";import{A as ut,a as vt,b as ft,H as _r}from"../chunks/BsZPXoma.js";import{S as gr}from"../chunks/DKjgU9O5.js";import{X as hr}from"../chunks/IyBdFYj9.js";var $r=f('<div class="absolute top-[20dvh]"><h1 class="mb-4 text-center text-3xl font-bold md:text-4xl"> </h1> <p class=" text-center"> </p></div>'),xr=f(" <!>",1),br=f("<!> ",1),yr=f("<!> <!>",1),wr=f("<!> <!>",1),kr=f("<!> <!>",1),Sr=f('<div class="group flex min-h-9 w-full flex-col items-center justify-center rounded-md border-input bg-background px-3 py-2 font-medium shadow-md"><div class="flex w-full items-center justify-between text-sm"><!> <!></div> <!> <!></div>'),Pr=f("<!> <!> <!>",1),Dr=f("<!> <!>",1),Or=f(" <!>",1),Tr=f("<!> <!>",1),jr=f('<a target="_blank" class="underline"> </a>'),Cr=f("<!> <!>",1),Rr=f("<!> <!>",1),Mr=f("<!> <!>",1),Ir=f("<!> <!>",1),Lr=f('<div class="w-full min-w-[256px] max-w-[512px] rounded-md border bg-background p-1 shadow-md"><!></div>'),zr=f("<div></div>"),Er=f('<!> <p> </p> <p class="font-semibold !text-cyan-700 dark:!text-cyan-400"> </p>',1),Ur=f('Лучшая <span class="!text-green-700 dark:!text-green-400">благодарность</span> <a class="font-semibold hover:underline" href="https://ma.cyou/">Автору</a>',1),qr=f('Best Thanks to the <a class="font-semibold hover:underline" href="https://ma.cyou/">Author</a>',1),Gr=f('это подписка на <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331">GitHub</a> и звездочка на <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331/ma">Репозиторий</a>',1),Ar=f('is a subscription on <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331">GitHub</a> and a star on <a class="font-semibold italic !text-green-700 hover:underline dark:!text-green-400" href="https://github.com/Mapagmataas1331/ma">Repository</a>',1),Br=f("<!> <!> <!>",1),Fr=f("<!> <!>",1),Hr=f('<div><!> <!> <div class="md:1/2 m-1 mt-3 flex w-full flex-col gap-y-2 md:w-[512px]"><div class="flex flex-row gap-0"><!> <!></div> <!></div> <!> <!></div>');function aa(pt,mt){Ut(mt,!0);const[Ae,_t]=zt(),y=()=>Qe(Ft,"$language",Ae),et=()=>Qe(Vt,"$page",Ae),gt=()=>Qe(cr,"$viewport",Ae),tt={day:0,time:2};let p=ee(""),Ie=ee(!1),Be=ee(null);function ht(){o(Ie,!1),Ke().then(()=>{e(Be).focus()})}let U=ee(O({start:Re(Me()),end:Re(Me()).add({days:6})})),$e=ee(""),z=null,Le={},ve=ee(O({})),fe=ee(O({})),Fe=ee(!1),T=ee(""),re=ee(null),q=null;const $t=async()=>{o(T,"loading");const r=await dt("student");if((r.scheduleError||!r.schedule)&&(e(re)||!z)){o(T,"error"),o(re,O(r.scheduleError)),q&&clearInterval(q);return}z=r.schedule,o(re,O(r.scheduleError)),await Ke(),o(T,"hidden"),o(ve,O(yt())),Le=St()},ze=async(r=!0)=>{bt(),e(p)&&(o(Fe,!0),e(p)&&e(U)&&(He(),r&&o($e,O(e(p)))),q&&clearInterval(q),await Ke(),q=setInterval(async()=>{if(!e(p)){q&&clearInterval(q);return}const a=await dt("student");if((a.scheduleError||!a.schedule)&&(e(re)||!z)){o(T,"error"),o(re,O(a.scheduleError)),q&&clearInterval(q);return}if(z=a.schedule,Ce.success(y()==="ru"?"Расписание обновлено в "+new Date().toLocaleString("ru-RU",{hour12:!1}):"Schedule updated at "+new Date().toLocaleString("en-US",{hour12:!1})),!e(p)){q&&clearInterval(q);return}He()},3e5))},xt=()=>{e(p)&&e(U)&&He()},He=()=>{if(!e(U).start||!e(U).end){o(T,"hidden");return}o(T,"loading");const r=it(e(U).start),a=it(e(U).end);let s=[],c=r;for(;c<=a;){const v=String(c.getDate()).padStart(2,"0"),l=String(c.getMonth()+1).padStart(2,"0"),_=c.getFullYear().toString().slice(-2),u=`${v}.${l}.${_}`;s.push(u),c.setDate(c.getDate()+1)}o(fe,O(s.reduce((v,l)=>{if(!z)return o(re,"Error: Schedule is null"),o(T,"error"),{};let _=[];if(Le[l])for(let u=Le[l];u<Le[wt(l)];u+=3){const j=z[u][tt.time],w=z[u][e(ve)[e(p)]],g=z[u+1][e(ve)[e(p)]],m=z[u+2][e(ve)[e(p)]],h=z[u][e(ve)[e(p)]+1];w&&_.push({time:j||"",discipline:w||"",type:g||"",teacher:m||"",auditorium:h||""})}return v[l]=_,v},{}))),o(T,"visible")},bt=()=>{o(T,"hidden"),o(fe,O({})),o(Fe,!1),o(U,O({start:Re(Me()),end:Re(Me()).add({days:6})}))},yt=()=>z?z[0].reduce((r,a,s)=>(s>2&&a&&!r[a]&&(r[a]=s),r),{}):(o(re,"Error: Schedule is null"),o(T,"error"),{}),wt=r=>{const[a,s,c]=r.split("."),v=new Date(`20${c}-${s}-${a}`);v.setDate(v.getDate()+1);const l=String(v.getDate()).padStart(2,"0"),_=String(v.getMonth()+1).padStart(2,"0"),u=v.getFullYear().toString().slice(-2);return`${l}.${_}.${u}`},kt=(r,a="ru")=>{let s=[];a==="ru"?s=["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"]:s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];const[c,v,l]=r.split("."),_=new Date(`20${l}-${v}-${c}`);return s[_.getDay()]||"Неизвестный день!"},St=()=>z?z.reduce((r,a,s)=>{const c=a[tt.day].split(" ")[1];return s>0&&c&&c!=="undefined"&&/\b(\d{2}\.\d{2}\.\d{2})\b/.test(c)&&(r[c]=s),r},{}):(o(re,"Error: Schedule is null"),o(T,"error"),{});Wt(async()=>{await $t(),o($e,O(localStorage.getItem("lq")||"")),Gt((a=e($e))=>{localStorage.setItem("lq",a)});const r=et().url.searchParams.get("q")||et().url.searchParams.get("group")||"";if(r){const a=decodeURI(r);if(!e(ve)[a]){Ce.error(y()==="ru"?`Некорректная группа передана в URL: "${a}"`:`Incorrect group passed in URL: "${a}"`);return}o(p,O(a)),ze(!1),Ce.success(y()==="ru"?`Группа "${a}" успешно загружена из URL`:`"${a}" group are successfully loaded from URL`);const s=new URL(window.location.href);s.searchParams.delete("year"),s.searchParams.delete("group"),s.searchParams.delete("q"),history.replaceState({},"",s.toString())}}),Yt(()=>{q&&clearInterval(q)});var Ee=Hr(),rt=Q(Ee);{var Pt=r=>{var a=$r(),s=Q(a),c=Q(s,!0);H(s);var v=i(s,2),l=Q(v,!0);H(v),H(a),b(()=>{x(c,y()==="ru"?"Расписание НГОК":"NGOK Schedule"),x(l,y()==="ru"?"Выберите группу, чтобы увидеть расписание":"Select a group to see the schedule")}),t(r,a)};M(rt,r=>{e(T)!=="visible"&&r(Pt)})}var at=i(rt,2);Ge(at,{variant:"outline",size:"icon",class:"fixed right-14 top-2.5 z-40 md:right-16 md:top-3.5",onclick:()=>{e(p)?(navigator.clipboard.writeText(`${window.location.origin}?q=${encodeURI(e(p))}`),Ce.success(y()==="ru"?`Ссылка для группы "${e(p)}" скопирована в буфер обмена!`:`Link for "${e(p)}" group copied to clipboard!`)):Ce.error(y()==="ru"?"Сначала выберите группу":"Select a year and group first")},children:(r,a)=>{Qt(r,{class:"!size-5"})},$$slots:{default:!0}});var Ne=i(at,2),Ve=Q(Ne),st=Q(Ve);d(st,()=>sr,(r,a)=>{a(r,{get open(){return e(Ie)},set open(s){o(Ie,O(s))},children:(s,c)=>{var v=kr(),l=n(v);d(l,()=>Kt,(u,j)=>{j(u,{get ref(){return e(Be)},set ref(g){o(Be,O(g))},child:(g,m)=>{let h=()=>m==null?void 0:m().props;const $=te(()=>`w-full justify-between px-3 py-2${e(p)?" rounded-r-none border-r-0":""}`);Ge(g,Et({variant:"outline",get class(){return e($)}},h,{role:"combobox",get"aria-expanded"(){return e(Ie)},children:(C,P)=>{L();var R=xr(),S=n(R),N=i(S);ar(N,{class:"opacity-50"}),b(()=>x(S,`${(e(p)?e(p):y()==="ru"?"Выберите группу":"Select a group")??""} `)),t(C,R)},$$slots:{default:!0}}))},$$slots:{child:!0}})});var _=i(l,2);d(_,()=>Xt,(u,j)=>{j(u,{class:"z-10 mt-[3px] w-[calc(100dvw-8px)] p-0 md:w-[256px]",children:(w,g)=>{var m=I(),h=n(m);d(h,()=>Jt,($,C)=>{C($,{children:(P,R)=>{var S=wr(),N=n(S);const ae=te(()=>y()==="ru"?"Искать группу":"Search for a group");d(N,()=>Zt,(k,E)=>{E(k,{get placeholder(){return e(ae)},class:"h-9"})});var xe=i(N,2);d(xe,()=>er,(k,E)=>{E(k,{children:(We,lt)=>{var be=yr(),ye=n(be);d(ye,()=>tr,(De,se)=>{se(De,{children:(pe,Oe)=>{L();var oe=F();b(()=>x(oe,y()==="ru"?"Нет результатов":"No results")),t(pe,oe)},$$slots:{default:!0}})});var Pe=i(ye,2);d(Pe,()=>rr,(De,se)=>{se(De,{class:"max-h-[256px] overflow-y-auto",children:(pe,Oe)=>{var oe=I(),K=n(oe);Xe(K,17,()=>Object.keys(e(ve)),Je,(de,V)=>{var le=I(),me=n(le);d(me,()=>or,(G,D)=>{D(G,{get value(){return e(V)},onSelect:()=>{o(p,O(e(V))),ze(),ht()},children:(A,_e)=>{var W=br(),X=n(W);const we=te(()=>Ht(e(p)!==e(V)&&"text-transparent"));At(X,{get class(){return e(we)}});var ie=i(X);b(()=>x(ie,` ${e(V)??""}`)),t(A,W)},$$slots:{default:!0}})}),t(de,le)}),t(pe,oe)},$$slots:{default:!0}})}),t(We,be)},$$slots:{default:!0}})}),t(P,S)},$$slots:{default:!0}})}),t(w,m)},$$slots:{default:!0}})}),t(s,v)},$$slots:{default:!0}})});var Dt=i(st,2);{var Ot=r=>{Ge(r,{variant:"outline",size:"icon",class:"shrink-0 rounded-l-none border-l-0",onclick:()=>{o(p,""),ze()},children:(a,s)=>{hr(a,{class:"opacity-50"})},$$slots:{default:!0}})};M(Dt,r=>{e(p)&&r(Ot)})}H(Ve);var Tt=i(Ve,2);{var jt=r=>{var a=I();const s=te(()=>gt().vw>=ir.md?2:1),c=te(()=>y()==="ru"?"ru":"en");var v=n(a);Bt(v,()=>[e(s),e(c)],l=>{var _=Sr(),u=Q(_),j=Q(u);{var w=R=>{var S=F();b((N,ae)=>x(S,`${N??""} - ${ae??""}`),[()=>Ze(e(U).start),()=>Ze(e(U).end)]),t(R,S)},g=R=>{var S=F();b(()=>x(S,y()==="ru"?"Выберите период":"Select a range")),t(R,S)};M(j,R=>{e(U).start&&e(U).end?R(w):R(g,!1)})}var m=i(j,2);lr(m,{class:"size-4 opacity-50"}),H(u);var h=i(u,2);gr(h,{class:"mt-2 hidden group-hover:block"});var $=i(h,2);const C=te(()=>e(c)==="ru"?0:1),P=te(()=>e(c)==="ru"?"ru":"en");nr($,{get weekStartsOn(){return e(C)},get numberOfMonths(){return e(s)},class:"hidden capitalize group-hover:block",onValueChange:xt,get locale(){return e(P)},get value(){return e(U)},set value(R){o(U,O(R))}}),H(_),t(l,_)}),t(r,a)};M(Tt,r=>{e(Fe)&&r(jt)})}H(Ne);var ot=i(Ne,2);{var Ct=r=>{var a=I(),s=n(a);d(s,()=>ft,(c,v)=>{v(c,{class:"md:1/2 my-1 w-full md:w-[512px]",children:(l,_)=>{var u=Pr(),j=n(u);dr(j,{class:"size-8"});var w=i(j,2);d(w,()=>ut,(m,h)=>{h(m,{class:"!pl-12",children:($,C)=>{L();var P=F();b(()=>x(P,y()==="ru"?"Возникла проблема":"Error Occurred")),t($,P)},$$slots:{default:!0}})});var g=i(w,2);d(g,()=>vt,(m,h)=>{h(m,{class:"!pl-12",children:($,C)=>{L();var P=F();b(()=>x(P,e(re))),t($,P)},$$slots:{default:!0}})}),t(l,u)},$$slots:{default:!0}})}),t(r,a)},Rt=r=>{var a=I(),s=n(a);{var c=l=>{ur(l,{class:"md:1/2 my-1 h-8 w-full md:w-[512px]"})},v=l=>{var _=I(),u=n(_);{var j=w=>{var g=zr();Xe(g,21,()=>Object.entries(e(fe)),Je,(m,h)=>{let $=()=>e(h)[0],C=()=>e(h)[1];var P=Lr(),R=Q(P);d(R,()=>mr,(S,N)=>{N(S,{children:(ae,xe)=>{var k=Ir(),E=n(k);const We=te(()=>$()===Ze(Re(Me()))?"bg-green-100 dark:bg-green-800/50":C().length>0?"bg-blue-100 dark:bg-blue-800/50":"mt-4 bg-red-100 p-4 dark:bg-red-800/50");d(E,()=>fr,(be,ye)=>{ye(be,{get class(){return`text-base ${e(We)??""}`},children:(Pe,De)=>{var se=I(),pe=n(se);d(pe,()=>qe,(Oe,oe)=>{oe(Oe,{children:(K,de)=>{var V=Dr(),le=n(V);d(le,()=>ct,(G,D)=>{D(G,{class:"w-1/3 text-right font-semibold text-foreground",children:(A,_e)=>{L();var W=F();b(()=>x(W,$())),t(A,W)},$$slots:{default:!0}})});var me=i(le,2);d(me,()=>ct,(G,D)=>{D(G,{class:"w-2/3 text-left font-semibold text-foreground",children:(A,_e)=>{L();var W=F();b(X=>x(W,X),[()=>kt($(),y())]),t(A,W)},$$slots:{default:!0}})}),t(K,V)},$$slots:{default:!0}})}),t(Pe,se)},$$slots:{default:!0}})});var lt=i(E,2);d(lt,()=>pr,(be,ye)=>{ye(be,{class:"bg-background",children:(Pe,De)=>{var se=I(),pe=n(se);{var Oe=K=>{var de=Mr(),V=n(de);{var le=G=>{var D=I(),A=n(D);d(A,()=>qe,(_e,W)=>{W(_e,{children:(X,we)=>{var ie=I(),Ye=n(ie);d(Ye,()=>Se,(ge,he)=>{he(ge,{class:"text-center font-semibold italic",colspan:2,children:(Te,ce)=>{L();var J=Or();const Y=te(()=>{var ue;return(ue=C()[0])==null?void 0:ue.time});var ke=n(J),B=i(ke);{var je=ue=>{var Ue=F();const Z=te(()=>e(Y).includes("-")?e(Y).split("-")[0]:e(Y));b(ne=>x(Ue,ne),[()=>e(Z).includes(".")?e(Z).replace(/\./g,":"):e(Z)]),t(ue,Ue)};M(B,ue=>{e(Y)&&ue(je)})}b(()=>x(ke,`${(y()==="ru"?"Пары начинаются с":"Lessons start at")??""} `)),t(Te,J)},$$slots:{default:!0}})}),t(X,ie)},$$slots:{default:!0}})}),t(G,D)};M(V,G=>{C()[0].time!=="09:00 - 10:30"&&G(le)})}var me=i(V,2);Xe(me,17,C,Je,(G,D)=>{var A=Rr(),_e=n(A);d(_e,()=>qe,(X,we)=>{we(X,{children:(ie,Ye)=>{var ge=Tr(),he=n(ge);d(he,()=>Se,(ce,J)=>{J(ce,{class:"text-right",children:(Y,ke)=>{L();var B=F();b(je=>x(B,je),[()=>e(D).time.includes(".")?e(D).time.replace(/\./g,":"):e(D).time]),t(Y,B)},$$slots:{default:!0}})});var Te=i(he,2);d(Te,()=>Se,(ce,J)=>{J(ce,{class:"text-left",children:(Y,ke)=>{L();var B=F();b(()=>x(B,e(D).discipline)),t(Y,B)},$$slots:{default:!0}})}),t(ie,ge)},$$slots:{default:!0}})});var W=i(_e,2);d(W,()=>qe,(X,we)=>{we(X,{children:(ie,Ye)=>{var ge=Cr(),he=n(ge);d(he,()=>Se,(ce,J)=>{J(ce,{class:"text-right",children:(Y,ke)=>{var B=I(),je=n(B);{var ue=Z=>{var ne=jr(),Lt=Q(ne,!0);H(ne),b(()=>{Nt(ne,"href",e(D).auditorium),x(Lt,y()==="ru"?"Онлайн":"Online")}),t(Z,ne)},Ue=Z=>{var ne=F();b(()=>x(ne,e(D).auditorium)),t(Z,ne)};M(je,Z=>{e(D).auditorium.startsWith("http")?Z(ue):Z(Ue,!1)})}t(Y,B)},$$slots:{default:!0}})});var Te=i(he,2);d(Te,()=>Se,(ce,J)=>{J(ce,{class:"text-left",children:(Y,ke)=>{L();var B=F();b(()=>x(B,e(D).teacher)),t(Y,B)},$$slots:{default:!0}})}),t(ie,ge)},$$slots:{default:!0}})}),t(G,A)}),t(K,de)},oe=K=>{var de=I(),V=n(de);d(V,()=>Se,(le,me)=>{me(le,{class:"text-center font-semibold italic",colspan:2,children:(G,D)=>{L();var A=F();b(()=>x(A,y()==="ru"?"Нет пар":"No lessons")),t(G,A)},$$slots:{default:!0}})}),t(K,de)};M(pe,K=>{C().length>0?K(Oe):K(oe,!1)})}t(Pe,se)},$$slots:{default:!0}})}),t(ae,k)},$$slots:{default:!0}})}),H(P),t(m,P)}),H(g),b((m,h,$)=>nt(g,`mx-auto my-1.5 grid grid-cols-1 justify-items-center gap-x-2 gap-y-3 md:p-2${m??""}${h??""}${$??""}`),[()=>Object.keys(e(fe)).length>1?" lg:grid-cols-2 ":"",()=>Object.keys(e(fe)).length>2?" 2xl:grid-cols-3 ":"",()=>Object.keys(e(fe)).length>3?" min-[1792px]:grid-cols-4":""]),t(w,g)};M(u,w=>{e(T)==="visible"&&e(fe)&&w(j)},!0)}t(l,_)};M(s,l=>{e(T)==="loading"?l(c):l(v,!1)},!0)}t(r,a)};M(ot,r=>{e(T)==="error"?r(Ct):r(Rt,!1)})}var Mt=i(ot,2);{var It=r=>{var a=Fr(),s=n(a);{var c=l=>{Ge(l,{variant:"outline",class:"md:1/2 my-1 w-full !justify-start py-5 md:w-[512px]",onclick:async()=>{o(p,O(e($e))),ze()},children:(_,u)=>{var j=Er(),w=n(j);vr(w,{class:"ml-1 mr-2.5 !size-6 !text-cyan-700 dark:!text-cyan-400"});var g=i(w,2),m=Q(g,!0);H(g);var h=i(g,2),$=Q(h,!0);H(h),b(()=>{x(m,y()==="ru"?"Последний запрос: ":"Last query:"),x($,e($e))}),t(_,j)},$$slots:{default:!0}})};M(s,l=>{e($e)&&e(T)!=="loading"&&l(c)})}var v=i(s,2);d(v,()=>ft,(l,_)=>{_(l,{class:"md:1/2 my-1 w-full md:w-[512px]",children:(u,j)=>{var w=Br(),g=n(w);_r(g,{class:"size-8 !text-green-700 dark:!text-green-400"});var m=i(g,2);d(m,()=>ut,($,C)=>{C($,{class:"!pl-12",children:(P,R)=>{var S=I(),N=n(S);{var ae=k=>{var E=Ur();L(3),t(k,E)},xe=k=>{var E=qr();L(),t(k,E)};M(N,k=>{y()==="ru"?k(ae):k(xe,!1)})}t(P,S)},$$slots:{default:!0}})});var h=i(m,2);d(h,()=>vt,($,C)=>{C($,{class:"!pl-12",children:(P,R)=>{var S=I(),N=n(S);{var ae=k=>{var E=Gr();L(3),t(k,E)},xe=k=>{var E=Ar();L(3),t(k,E)};M(N,k=>{y()==="ru"?k(ae):k(xe,!1)})}t(P,S)},$$slots:{default:!0}})}),t(u,w)},$$slots:{default:!0}})}),t(r,a)};M(Mt,r=>{e(T)!=="visible"&&r(It)})}H(Ee),b(()=>nt(Ee,`${(e(p)?"justify-start":"justify-center")??""} mx-auto flex min-h-[calc(100dvh_-_3.5rem)] w-full flex-col items-center bg-gradient-to-br from-white to-sky-200 px-1 dark:from-sky-800 dark:to-black md:min-h-[calc(100dvh_-_4rem)]`)),t(pt,Ee),qt(),_t()}export{aa as component};
